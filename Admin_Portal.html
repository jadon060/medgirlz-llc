<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>MedGirlz ‚Ä¢ Admin Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="MedGirlz Admin Portal ‚Äî internal notes and tools." />
  <style>
    :root{
      /* MedGirlz palette */
      --bg:#fdf8f6;
      --card:#ffffff;
      --ink:#3f2f31;
      --muted:#856771;
      --line:rgba(197,115,136,0.16);
      --accent:#c57388;
      --accent-2:#d58fa0;
      --radius:18px;
      --shadow:0 18px 50px rgba(197,115,136,.12), 0 3px 12px rgba(0,0,0,.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    }

    /* top bar */
    header{
      position:sticky;
      top:0;
      z-index:10;
      background:#fff;
      border-bottom:1px solid rgba(0,0,0,0.02);
      display:flex;
      align-items:center;
      gap:10px;
      padding:12px 16px;
    }
    .brand{
      font-weight:800;
      letter-spacing:.2px;
      color:#6d424c;
    }
    .brand small{
      font-weight:600;
      color:var(--muted);
    }

    .container{
      max-width:1100px;
      margin:18px auto;
      padding:0 16px;
    }

    .hero{
      background:linear-gradient(135deg, rgba(197,115,136,.14), rgba(213,143,160,.05));
      border:1px solid rgba(197,115,136,.12);
      border-radius:20px;
      padding:20px 18px 22px 18px;
      box-shadow:var(--shadow);
    }
    .hero h1{
      margin:0 0 4px;
      font-size:28px;
      color:#643843;
    }
    .hero .tagline{
      color:var(--muted);
      margin:0 0 14px;
    }

    .grid{
      display:grid;
      gap:16px;
      margin-top:16px;
    }
    /* only 1 column right now but keep responsive */
    @media (min-width:820px){
      .grid{grid-template-columns:1fr 0.001fr;} /* fake 2nd col to keep structure */
    }

    .card{
      background:var(--card);
      border:1px solid rgba(197,115,136,0.05);
      border-radius:18px;
      padding:16px 16px 18px 16px;
      box-shadow:var(--shadow);
    }
    .card h2{
      margin:2px 0 12px;
      font-size:18px;
      display:flex;
      align-items:center;
      gap:8px;
      color:#5d343e;
    }

    /* notes controls */
    .notes-controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin:6px 0 10px;
    }
    .notes-controls input[type="text"]{
      flex:1 1 260px;
      padding:8px 10px;
      border:1px solid var(--line);
      border-radius:10px;
      background:#fff;
    }
    .btn{
      appearance:none;
      border:1px solid rgba(197,115,136,0.15);
      background:var(--accent);
      color:#fff;
      border-radius:12px;
      padding:7px 12px 8px 12px;
      font-weight:700;
      box-shadow:0 6px 16px rgba(197,115,136,0.24);
      cursor:pointer;
      font-size:0.85rem;
    }
    .btn.ghost{
      background:#fff;
      color:var(--ink);
    }
    .btn.warn{
      background:#be2a2a;
      border-color:#9d2121;
      color:#fff;
    }

    textarea#noteText{
      width:100%;
      min-height:120px;
      padding:12px;
      border:1px solid var(--line);
      border-radius:12px;
      resize:vertical;
      font-family:inherit;
    }

    .muted{color:var(--muted);}

    .chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(213,143,160,0.16);
      border:1px solid rgba(213,143,160,0.3);
      color:#5a3a43;
      padding:5px 10px 5px 8px;
      border-radius:999px;
      font-size:12px;
      margin-bottom:6px;
    }

    .note-row{
      display:grid;
      grid-template-columns:1fr auto;
      gap:10px;
      align-items:start;
      padding:10px 10px 10px 12px;
      border:1px solid rgba(197,115,136,0.09);
      border-radius:12px;
      background:#fefbfb;
    }
    .note-meta{
      font-size:12px;
      color:var(--muted);
      margin-bottom:5px;
    }
    .note-actions{
      display:flex;
      gap:6px;
    }

    footer{
      color:var(--muted);
      font-size:13px;
      text-align:center;
      padding:24px 0 36px;
    }
    a.home-link{
      color:#c57388;
      text-decoration:none;
      font-weight:600;
    }
  </style>

  <script>
    // gatekeep using the same key your login page currently sets
    (function(){
      try{
        if(localStorage.getItem("ESS_Admin_Login")!=="true"){
          // send back to the login in the same folder
          location.replace("./login.html");
        }
      }catch(e){
        location.replace("./login.html");
      }
    })();
  </script>
</head>
<body>
  <header class="container">
    <div class="brand">MedGirlz ‚Ä¢ <small>Admin Portal</small></div>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Welcome, Rianne üëãüèΩ</h1>
      <p class="tagline">Your private workspace for MedGirlz notes. Saved to this device only.</p>

      <div class="grid">
        <!-- single card for now -->
        <div class="card">
          <h2>üóíÔ∏è My Notes</h2>
          <p class="muted" style="margin-top:-4px">Organize conversations, calls, refills, staff tasks ‚Äî whatever you need.</p>

          <div class="notes-controls">
            <input id="search" type="text" placeholder="Search notes (client, date, keyword)‚Ä¶" />
            <button class="btn ghost" id="exportJson">Export</button>
            <label class="btn ghost" for="importFile" style="cursor:pointer">Import</label>
            <input id="importFile" type="file" accept=".json" style="display:none" />
            <button class="btn warn" id="clearAll">Clear All</button>
          </div>

          <div class="chip">
            <input id="prependTs" type="checkbox" checked style="margin:0" />
            <label for="prependTs" style="cursor:pointer">Prepend timestamp</label>
          </div>

          <textarea id="noteText" placeholder="Example: 11/07 ‚Äî Called parent, updated medication record, next check 12/07."></textarea>
          <div style="display:flex;gap:10px;margin-top:10px">
            <button class="btn" id="saveNote">Save (Ctrl+Enter)</button>
            <span class="muted" id="saveStatus" aria-live="polite"></span>
          </div>

          <div style="margin-top:16px" id="notesList"></div>
        </div>
      </div>
    </section>

    <footer>
      ¬© <span id="y"></span> MedGirlz LLC ‚Ä¢ Admin Portal
      ¬∑ <a class="home-link" href="./index.html">Back to site</a>
    </footer>
  </main>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // keep the same behavior ‚Äî local only
    const LS_KEY = "MGZ_Admin_PrivateNotes_v1";  // MGZ name so it doesn‚Äôt clash with ESS
    const $ = sel => document.querySelector(sel);
    const notesList = $("#notesList");
    const searchBox = $("#search");
    const statusEl = $("#saveStatus");

    function loadNotes(){
      try { return JSON.parse(localStorage.getItem(LS_KEY)) || []; }
      catch { return []; }
    }
    function persist(notes){ localStorage.setItem(LS_KEY, JSON.stringify(notes)); }
    function nowStamp(){
      const d = new Date();
      return d.toLocaleString(undefined, {
        year:'2-digit', month:'2-digit', day:'2-digit',
        hour:'2-digit', minute:'2-digit'
      });
    }
    function saveNote(){
      const txt = $("#noteText").value.trim();
      if(!txt) return;
      const notes = loadNotes();
      const body = $("#prependTs").checked ? `${nowStamp()} ‚Äî ${txt}` : txt;
      notes.unshift({ id: crypto.randomUUID(), ts: new Date().toISOString(), body });
      persist(notes);
      $("#noteText").value = "";
      flash("Saved");
      render();
    }
    function deleteNote(id){
      const notes = loadNotes().filter(n => n.id !== id);
      persist(notes);
      render();
    }
    async function copyNote(text){
      try{
        await navigator.clipboard.writeText(text);
        flash("Copied");
      }catch{
        flash("Copy failed");
      }
    }
    function exportJson(){
      const blob = new Blob([JSON.stringify(loadNotes(), null, 2)], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = `MGZ_PrivateNotes_${new Date().toISOString().slice(0,10)}.json`;
      a.click();
      URL.revokeObjectURL(a.href);
    }
    function importJson(file){
      const reader = new FileReader();
      reader.onload = () => {
        try{
          const imported = JSON.parse(reader.result);
          if(!Array.isArray(imported)) throw new Error("Invalid file");
          const map = new Map();
          [...imported, ...loadNotes()].forEach(n => {
            const id = n.id || crypto.randomUUID();
            map.set(id, {
              id,
              ts: n.ts || new Date().toISOString(),
              body: String(n.body || "")
            });
          });
          const merged = [...map.values()].sort((a,b)=> (b.ts||"").localeCompare(a.ts||""));
          persist(merged);
          render();
          flash("Imported");
        }catch(e){
          flash("Import failed");
        }
      };
      reader.readAsText(file);
    }
    function clearAll(){
      if(confirm("Delete ALL private notes on this device?")){
        persist([]);
        render();
      }
    }
    function flash(msg){
      statusEl.textContent = msg;
      setTimeout(()=> statusEl.textContent = "", 1200);
    }
    function render(){
      const q = (searchBox.value || "").toLowerCase();
      const notes = loadNotes().filter(n => n.body.toLowerCase().includes(q));
      if(notes.length === 0){
        notesList.innerHTML = `<p class="muted">No notes yet.</p>`;
        return;
      }
      notesList.innerHTML = notes.map(n => {
        const when = new Date(n.ts).toLocaleString();
        return `
          <div class="note-row">
            <div>
              <div class="note-meta">${when}</div>
              <div style="white-space:pre-wrap">${escapeHtml(n.body)}</div>
            </div>
            <div class="note-actions">
              <button class="btn ghost" onclick='(${copyNote}).call(null, ${JSON.stringify(n.body)})'>Copy</button>
              <button class="btn warn" onclick='(${deleteNote}).call(null, "${n.id}")'>Delete</button>
            </div>
          </div>
        `;
      }).join("");
    }
    function escapeHtml(s){
      return s.replace(/[&<>"']/g, m => ({
        '&':'&amp;',
        '<':'&lt;',
        '>':'&gt;',
        '"':'&quot;',
        "'":'&#39;'
      }[m]));
    }

    $("#saveNote").addEventListener("click", saveNote);
    $("#noteText").addEventListener("keydown", e => {
      if(e.ctrlKey && e.key === 'Enter') saveNote();
    });
    $("#exportJson").addEventListener("click", exportJson);
    $("#importFile").addEventListener("change", e => e.target.files[0] && importJson(e.target.files[0]));
    $("#clearAll").addEventListener("click", clearAll);
    searchBox.addEventListener("input", render);

    render();
  </script>
</body>
</html>
